<div class="notifications-container">
    <button class="notification-bell" (click)="toggleDropdown()" mat-icon-button>
        <mat-icon [matBadge]="unreadCount()" [matBadgeHidden]="unreadCount() === 0" matBadgeColor="warn">
            notifications
        </mat-icon>
    </button>

    @if (isOpen) {
    <div class="notifications-dropdown">
        <div class="dropdown-header">
            <h3>Notificações</h3>
            @if (unreadCount() > 0) {
            <button mat-button (click)="markAllAsRead()" class="mark-all-btn">
                Marcar todas como lidas
            </button>
            }
        </div>

        <div class="notifications-list">
            @if (notifications().length === 0) {
            <div class="empty-state">
                <mat-icon>notifications_none</mat-icon>
                <p>Nenhuma notificação</p>
            </div>
            } @else {
            @for (notification of notifications(); track notification.id) {
            <div class="notification-item" [class.unread]="!notification.read" (click)="markAsRead(notification)">
                <div class="notification-icon">
                    <mat-icon [class]="'icon-' + notification.type">
                        {{ getNotificationIcon(notification.type) }}
                    </mat-icon>
                </div>
                <div class="notification-content">
                    <h4>{{ notification.title }}</h4>
                    <p>{{ notification.message }}</p>
                    <span class="notification-time">{{ getTimeAgo(notification.createdAt) }}</span>
                </div>
                @if (!notification.read) {
                <div class="unread-indicator"></div>
                }
            </div>
            }
            }
        </div>
    </div>
    }
</div>

<!-- Backdrop -->
@if (isOpen) {
<div class="notifications-backdrop" (click)="toggleDropdown()"></div>
}