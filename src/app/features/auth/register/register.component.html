<div class="register-container">
    <!-- Step 1: Sele√ß√£o de Tipo -->
    @if (currentStep === 1) {
    <div class="type-selection">
        <div class="selection-header">
            <h1>Junte-se ao ConectaVolunt√°rio</h1>
            <p class="subtitle">Escolha como voc√™ quer fazer a diferen√ßa</p>
        </div>

        <div class="type-cards">
            <div class="type-card volunteer-card" (click)="selectUserType(UserType.VOLUNTEER)">
                <div class="card-badge">Mais Popular</div>
                <div class="card-icon">üôã‚Äç‚ôÇÔ∏è</div>
                <h3>Sou Volunt√°rio</h3>
                <p>Encontre oportunidades incr√≠veis para ajudar sua comunidade e desenvolver novas habilidades</p>
                <ul class="benefits-list">
                    <li>‚úì Acesso a centenas de oportunidades</li>
                    <li>‚úì Conecte-se com ONGs verificadas</li>
                    <li>‚úì Acompanhe seu impacto</li>
                </ul>
                <button mat-flat-button color="primary" class="select-btn">Come√ßar Agora</button>
            </div>

            <div class="type-card ngo-card" (click)="selectUserType(UserType.NGO)">
                <div class="card-icon">üè¢</div>
                <h3>Sou uma ONG</h3>
                <p>Divulgue seus projetos e encontre volunt√°rios engajados para sua causa</p>
                <ul class="benefits-list">
                    <li>‚úì Crie e gerencie projetos</li>
                    <li>‚úì Encontre volunt√°rios qualificados</li>
                    <li>‚úì Aumente seu alcance</li>
                </ul>
                <button mat-flat-button color="primary" class="select-btn">Cadastrar ONG</button>
            </div>
        </div>

        <div class="login-link">
            <p>J√° tem uma conta? <a routerLink="/login">Fa√ßa login</a></p>
        </div>
    </div>
    }

    <!-- Step 2: Formul√°rio -->
    @if (currentStep === 2) {
    <mat-card class="register-card">
        <button mat-icon-button class="back-button" (click)="goBack()">
            ‚Üê
        </button>

        <mat-card-header>
            <div class="header-icon">
                @if (selectedUserType === UserType.VOLUNTEER) {
                üôã‚Äç‚ôÇÔ∏è
                } @else {
                üè¢
                }
            </div>
            <mat-card-title>
                @if (selectedUserType === UserType.VOLUNTEER) {
                Cadastro de Volunt√°rio
                } @else {
                Cadastro de ONG
                }
            </mat-card-title>
            <mat-card-subtitle>Preencha seus dados para come√ßar sua jornada</mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
            <!-- Formul√°rio Volunt√°rio -->
            @if (selectedUserType === UserType.VOLUNTEER) {
            <form [formGroup]="volunteerForm" (ngSubmit)="onSubmit()">
                <div class="form-section">
                    <h4 class="section-title">Informa√ß√µes Pessoais</h4>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Nome Completo</mat-label>
                        <input matInput formControlName="name" placeholder="Ex: Jo√£o Silva">
                        <mat-error>{{ getErrorMessage(volunteerForm, 'name') }}</mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>E-mail</mat-label>
                        <input matInput formControlName="email" type="email" placeholder="seu@email.com">
                        <mat-error>{{ getErrorMessage(volunteerForm, 'email') }}</mat-error>
                    </mat-form-field>

                    <div class="form-row">
                        <mat-form-field appearance="outline" class="half-width">
                            <mat-label>Usu√°rio</mat-label>
                            <input matInput formControlName="username" placeholder="usuario123">
                            <mat-error>{{ getErrorMessage(volunteerForm, 'username') }}</mat-error>
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="half-width">
                            <mat-label>Telefone</mat-label>
                            <input matInput formControlName="phone" placeholder="(11) 99999-9999"
                                (input)="formatPhone($event, volunteerForm)">
                            <mat-hint>Opcional</mat-hint>
                            <mat-error>{{ getErrorMessage(volunteerForm, 'phone') }}</mat-error>
                        </mat-form-field>
                    </div>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Senha</mat-label>
                        <input matInput formControlName="password" type="password">
                        <mat-hint>M√≠nimo 8 caracteres, com letra mai√∫scula e n√∫mero</mat-hint>
                        <mat-error>{{ getErrorMessage(volunteerForm, 'password') }}</mat-error>
                    </mat-form-field>

                    @if (volunteerForm.get('password')?.value) {
                    <div class="password-strength-container">
                        <div class="password-strength-bar" [class]="passwordStrength">
                            <div class="password-strength-fill"></div>
                        </div>
                        <span class="password-strength-text">For√ßa: {{ passwordStrengthText }}</span>
                    </div>
                    }

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Confirmar Senha</mat-label>
                        <input matInput formControlName="passwordConfirm" type="password">
                        <mat-error>{{ getErrorMessage(volunteerForm, 'passwordConfirm') }}</mat-error>
                    </mat-form-field>
                </div>

                <div class="form-section">
                    <h4 class="section-title">Sobre Voc√™</h4>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>√Åreas de Interesse</mat-label>
                        <input matInput formControlName="interests" placeholder="Ex: Educa√ß√£o, Meio Ambiente, Sa√∫de">
                        <mat-hint>Separe por v√≠rgula</mat-hint>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Habilidades</mat-label>
                        <input matInput formControlName="skills" placeholder="Ex: Ensino, Cozinha, Programa√ß√£o">
                        <mat-hint>Separe por v√≠rgula</mat-hint>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Conte um pouco sobre voc√™</mat-label>
                        <textarea matInput formControlName="bio" rows="3"
                            placeholder="Por que voc√™ quer ser volunt√°rio?"></textarea>
                    </mat-form-field>
                </div>

                <div class="terms-section">
                    <mat-checkbox formControlName="acceptTerms" class="terms-checkbox">
                        <span class="terms-text">
                            Li e aceito os <a routerLink="/terms" target="_blank">Termos de Uso</a> e a
                            <a routerLink="/privacy" target="_blank">Pol√≠tica de Privacidade</a>
                        </span>
                    </mat-checkbox>
                    <p class="lgpd-notice">
                        <mat-icon>info</mat-icon>
                        Seus dados ser√£o tratados conforme a LGPD (Lei n¬∫ 13.709/2018)
                    </p>
                </div>

                <button mat-flat-button color="primary" class="full-width submit-btn" type="submit"
                    [disabled]="volunteerForm.invalid">
                    Criar Minha Conta
                </button>
            </form>
            }

            <!-- Formul√°rio ONG -->
            @if (selectedUserType === UserType.NGO) {
            <form [formGroup]="ngoForm" (ngSubmit)="onSubmit()">
                <div class="form-section">
                    <h4 class="section-title">Informa√ß√µes da Organiza√ß√£o</h4>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Nome da Organiza√ß√£o</mat-label>
                        <input matInput formControlName="organizationName" placeholder="Ex: Instituto Ajudar">
                        <mat-error>{{ getErrorMessage(ngoForm, 'organizationName') }}</mat-error>
                    </mat-form-field>

                    <div class="form-row">
                        <mat-form-field appearance="outline" class="half-width">
                            <mat-label>CNPJ</mat-label>
                            <input matInput formControlName="cnpj" placeholder="00.000.000/0000-00"
                                (input)="formatCNPJ($event)">
                            <mat-error>{{ getErrorMessage(ngoForm, 'cnpj') }}</mat-error>
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="half-width">
                            <mat-label>Telefone</mat-label>
                            <input matInput formControlName="phone" placeholder="(11) 3333-3333"
                                (input)="formatPhone($event, ngoForm)">
                            <mat-hint>Opcional</mat-hint>
                            <mat-error>{{ getErrorMessage(ngoForm, 'phone') }}</mat-error>
                        </mat-form-field>
                    </div>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>E-mail Institucional</mat-label>
                        <input matInput formControlName="email" type="email" placeholder="contato@ong.org.br">
                        <mat-error>{{ getErrorMessage(ngoForm, 'email') }}</mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Website</mat-label>
                        <input matInput formControlName="website" placeholder="https://www.suaong.org.br">
                        <mat-hint>Opcional</mat-hint>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Endere√ßo</mat-label>
                        <input matInput formControlName="address" placeholder="Rua, n√∫mero, bairro, cidade">
                        <mat-hint>Opcional</mat-hint>
                    </mat-form-field>
                </div>

                <div class="form-section">
                    <h4 class="section-title">Acesso ao Sistema</h4>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Usu√°rio</mat-label>
                        <input matInput formControlName="username" placeholder="usuario_ong">
                        <mat-error>{{ getErrorMessage(ngoForm, 'username') }}</mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Senha</mat-label>
                        <input matInput formControlName="password" type="password">
                        <mat-hint>M√≠nimo 8 caracteres, com letra mai√∫scula e n√∫mero</mat-hint>
                        <mat-error>{{ getErrorMessage(ngoForm, 'password') }}</mat-error>
                    </mat-form-field>

                    @if (ngoForm.get('password')?.value) {
                    <div class="password-strength-container">
                        <div class="password-strength-bar" [class]="passwordStrength">
                            <div class="password-strength-fill"></div>
                        </div>
                        <span class="password-strength-text">For√ßa: {{ passwordStrengthText }}</span>
                    </div>
                    }

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Confirmar Senha</mat-label>
                        <input matInput formControlName="passwordConfirm" type="password">
                        <mat-error>{{ getErrorMessage(ngoForm, 'passwordConfirm') }}</mat-error>
                    </mat-form-field>
                </div>

                <div class="form-section">
                    <h4 class="section-title">Sobre a Organiza√ß√£o</h4>

                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Descri√ß√£o</mat-label>
                        <textarea matInput formControlName="description" rows="4"
                            placeholder="Conte sobre a miss√£o e atividades da sua organiza√ß√£o"></textarea>
                        <mat-error>{{ getErrorMessage(ngoForm, 'description') }}</mat-error>
                    </mat-form-field>
                </div>

                <div class="terms-section">
                    <mat-checkbox formControlName="acceptTerms" class="terms-checkbox">
                        <span class="terms-text">
                            Li e aceito os <a routerLink="/terms" target="_blank">Termos de Uso</a> e a
                            <a routerLink="/privacy" target="_blank">Pol√≠tica de Privacidade</a>
                        </span>
                    </mat-checkbox>
                    <p class="lgpd-notice">
                        <mat-icon>info</mat-icon>
                        Seus dados ser√£o tratados conforme a LGPD (Lei n¬∫ 13.709/2018)
                    </p>
                </div>

                <button mat-flat-button color="primary" class="full-width submit-btn" type="submit"
                    [disabled]="ngoForm.invalid">
                    Cadastrar Organiza√ß√£o
                </button>
            </form>
            }
        </mat-card-content>
    </mat-card>
    }
</div>